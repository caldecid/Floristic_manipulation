##start a selenium server
driver <- rsDriver(browser = "chrome",
chromever = NULL,
verbose = FALSE)
binman::list_versions("iedriverserver")
binman::list_versions("chromedriver")
binman::list_versions("iedriverserver")
binman::list_versions("phantomjs")
binman::list_versions("geckodriver")
install.packages("ggplot2")
library(ggplot2)
View(df_ipni_powo_absent)
View(df_ipni_powo_absent)
df_ipni_powo_absent %>% group_by(family) %>% count(species)
library(dplyr)
df_ipni_powo_absent %>% group_by(family) %>% count(species)
df_ipni_powo_absent %>% group_by(family) %>% count()
df_ipni_powo_absent %>% group_by(family) %>% count() %>% filter(n >= 50)
x <- df_ipni_powo_absent %>% group_by(family) %>% count() %>% filter(n >= 50)
View(x)
x <- df_ipni_powo_absent %>% group_by(family) %>% count() %>% filter(n >= 70)
View(x)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>% filter(n >= 70)
View(x)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count()
View(x)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count(n > 20)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count(n >= 20)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>%
filter(n >= 20)
View(x)
View(x)
unique(x$family)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>%
filter(n >= 25)
View(x)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>%
filter(n >= 20)
p <- ggplot(x, aes(x=as.factor(genus), y=n)) +
geom_bar(stat="identity", fill=alpha("blue", 0.3)) +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-100,120) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal()
p
p <- ggplot(x, aes(x=as.factor(genus), y=n)) +
geom_bar(stat="identity", fill=alpha("blue", 0.3)) +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-100,120) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal()+
coord_polar(start = 0)
p
p
p
View(x)
x <- df_ipni_powo_absent %>% group_by(family) %>% count(genus) %>%
filter(n >= 20)
View(x)
x <- df_ipni_powo_absent %>% group_by(family) %>% count(genus)
View(x)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>%
filter(n >= 20)
x <- df_ipni_powo_absent %>% group_by(family, genus) %>% count() %>%
filter(n >= 25)
View(x)
x <- df_ipni_powo_absent %>% group_by(family) %>% count(genus)
View(x)
View(df_ipni_powo_absent)
x <- df_ipni_powo_absent %>% group_by(family) %>% count()
View(x)
df_ipni_powo_absent %>% filter(family == "Acanthaceae")
y <- df_ipni_powo_absent %>% filter(family == "Acanthaceae")
View(y)
x <- df_ipni_powo_absent %>% group_by(family) %>% n_distinct(genus)
x <- df_ipni_powo_absent %>% group_by(family) %>% n_distinct(genus)
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus)) %>% ungroup()
View(x)
length(unique(y$genus))
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(species)) %>% ungroup()
View(x)
length(unique(y$species))
View(y)
which(distinct(y$species))
which(duplicated(y$species))
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(names)) %>% ungroup()
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = count(names)) %>% ungroup()
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = count(name)) %>% ungroup()
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = n(name)) %>% ungroup()
x <- df_ipni_powo_absent %>% group_by(family) %>% summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>% ungroup()
View(x)
View(x)
p1 <- x %>% filter(unique_genus >= 20) %>%
ggplot(x = family, y = unique_genus)+
geom_bar()
p1
p1 <- x %>% filter(unique_genus >= 20) %>%
ggplot(x = family, y = unique_genus)+
geom_bar(stat = "identity")
p1
p1 <- x %>% filter(unique_genus >= 20) %>%
ggplot(aes(x = family, y = unique_genus))+
geom_bar(stat = "identity")
p1
View(x)
x <- df_ipni_powo_absent %>% group_by(family) %>%
summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>%
ungroup() %>%
pivot_longer(starts_with("unique"), names_to = taxon, values_to = number)
library(tidyr)
x <- df_ipni_powo_absent %>% group_by(family) %>%
summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>%
ungroup() %>%
pivot_longer(starts_with("unique"), names_to = taxon, values_to = number)
x <- df_ipni_powo_absent %>% group_by(family) %>%
summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>%
ungroup() %>%
pivot_longer(starts_with("unique"), names_to = "taxon", values_to = "number")
View(POWOcodes)
p1 <- x %>% filter(unique_genus >= 20) %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity")
p1 <- x %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity")
p1
p1 <- x %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge")
p1
mis_general <- df_ipni_powo_absent %>% group_by(family) %>%
summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>%
ungroup() %>%
pivot_longer(starts_with("unique"), names_to = "taxon", values_to = "number")
mis_plus20 <- df_ipni_powo_absent %>% group_by(family) %>%
summarise(unique_genus = n_distinct(genus),
unique_sp = n_distinct(name)) %>%
ungroup() %>% filter(unique_genus >= 20) %>%
pivot_longer(starts_with("unique"), names_to = "taxon", values_to = "number")
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge")
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
coord_flip()
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
coord_flip()+
theme_classic()
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Missing taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("genera", "species"))+
coord_flip()+
theme_classic()
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Missing taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("genera", "species"))+
coord_flip()+
theme_bw()
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Missing taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("genera", "species"))+
coord_flip()+
theme_classic()
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Missing taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("genera", "species"))+
coord_flip()+
theme_bw()
p2
theme_bw()
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("genera", "species"))+
coord_flip()+
xlab("Missing taxa")+
ylab("Family")+
theme_bw()
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Genus", "Species"))+
coord_flip()+
xlab("Missing taxa")+
ylab("Family")+
theme_bw()
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Genus", "Species"))+
coord_flip()+
xlab("Missing taxa")+
ylab("Family")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)))
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Genus", "Species"))+
coord_flip()+
xlab("Family")+
ylab("Missing number")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)))
p2
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)),
plot.title = element_text(family = "serif", size = (12),
face = "bold"))
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Genus", "Species"))+
coord_flip()+
xlab("Family")+
ylab("Missing number")+
ggtitle("Famílias com mais de 20 gêneros faltando no Flora")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)),
plot.title = element_text(family = "serif", size = (12),
face = "bold"))
p2
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Gênero", "Espécies"))+
coord_flip()+
xlab("Família")+
ylab("Número de taxa faltante")+
ggtitle("Famílias com mais de 20 gêneros com espécies faltando no Flora")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)),
plot.title = element_text(family = "serif", size = (12),
face = "bold"))
p2
png("text/Figures/missing_plus20.png",
width = 17, height = 18, units = "cm",
pointsize = 8, res = 300)
p2 <- mis_plus20 %>%
ggplot(aes(x = family, y = number, fill = taxon))+
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = c("#d8b365", "#5ab4ac"),
name = "Taxa",
breaks = c("unique_genus", "unique_sp"),
labels = c("Gênero", "Espécies"))+
coord_flip()+
xlab("Família")+
ylab("Número de taxa faltante")+
ggtitle("Famílias com mais de 20 gêneros com espécies faltando no Flora")+
theme_bw()+
theme(legend.position = "bottom",
legend.title = element_text(family = "serif", size = (11),
face = "bold"),
legend.text = element_text(family = "serif", size = (10)),
axis.title = element_text(family = "serif", size = (11),
face = "bold"),
axis.text = element_text(family = "serif", size = (11)),
plot.title = element_text(family = "serif", size = (12),
face = "bold"))
p2
dev.off()
library(kewr)
devtools::install_github("barnabywalker/kewr")
library(kewr)
library(dplyr)
library(readr)
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 1000))
View(Fabacea_ipni)
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 10000))
fabaceae_flora <- angiosperms_bra %>%
filter(Família == "Fabaceae")
View(fabaceae_flora)
View(fabaceae_flora)
View(Fabacea_ipni)
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 6000))
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 2000))
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 1000))
#######calling fabacea from ipni
Fabacea_ipni <- tidy(search_ipni(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 1500))
?search_ipni
?search_powo
Fabaceae_powo <- tidy(search_powo(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 2000))
View(Fabaceae_powo)
Fabaceae_powo <- tidy(search_powo(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 3000))
View(Fabaceae_powo)
Leguminosae_powo <- tidy(search_powo(list(family = "Leguminosae",
distribution = "Brazil"),
limit = 3000))
View(Leguminosae_powo)
Fabaceae_powo <- tidy(search_powo(list(family = "Fabaceae",
distribution = "Brazil"),
limit = 5000))
View(Fabaceae_powo)
View(Fabacea_ipni)
?search_ipni
Fabaceae_powo$name[1]
View(Fabacea_ipni)
Fabaceae_powo <- Fabaceae_powo %>% filter(rank == "Species")
Fabacea_ipni_sp <- tidy(search_powo(list(species = Fabaceae_powo$name[1]))
Fabacea_ipni_sp <- tidy(search_powo(list(species = Fabaceae_powo$name[1])))
Fabacea_ipni_sp <- tidy(search_powo(list(species = Fabaceae_powo$name[2])))
Fabacea_ipni_sp <- tidy(search_powo(species = Fabaceae_powo$name[2]))
Fabacea_ipni_sp <- tidy(search_powo(list(species = Fabaceae_powo$name[56])))
View(Fabacea_ipni)
Fabacea_ipni_sp <- tidy(search_powo(list(species = "Abarema barnebyana")))
limit = 1000)
Fabacea_ipni_sp <- tidy(search_ipni(list(family ="Fabaceae",
published = 2008:2020,
distribution = "Brazil",
filters=c("species"),
limit = 1000)))
Fabacea_ipni_sp <- tidy(search_ipni(list(family ="Fabaceae",
published = 2008:2020,
distribution = "Brazil",
#filters=c("species"),
limit = 1000)))
Fabacea_ipni_sp <- tidy(search_ipni(list(family ="Fabaceae",
published = 2008,
distribution = "Brazil",
#filters=c("species"),
limit = 1000)))
Fabacea_ipni_sp <- tidy(search_ipni(list(family ="Fabaceae",
#published = 2008,
distribution = "Brazil",
#filters=c("species"),
limit = 1000)))
search_ipni(list(genus="Poa", published=1920),
filters=c("species"))
search_ipni(list(family ="Fabaceae", published=2008),
filters=c("species"))
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008),
filters=c("species")))
View(x)
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008),
ditribution = "Brazil",
filters=c("species")))
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008),
distribution = "Brazil",
filters=c("species")))
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008),
distribution = "Brazil",
filters=c("species")))
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008,
distribution = "Brazil"),
filters=c("species")))
x <- tidy(search_ipni(list(family ="Fabaceae", published=2008:2020,
distribution = "Brazil"),
filters=c("species")))
x <- tidy(search_ipni(list(family ="Fabaceae", published = c(2008, 2009),
distribution = "Brazil"),
filters=c("species")))
x <- 2008:2020
fabacea_list <- vector("list", length(x))
for(i in seq_along(x)){
fabacea_list[[x]] <- tidy(search_ipni(list(family ="Fabaceae",
published = x[i],
distribution = "Brazil"),
filters=c("species")))
}
x <- 2008:2020
fabacea_list <- vector("list", length(x))
for(i in seq_along(x)){
fabacea_list[[x]] <- tidy(search_ipni(list(family = "Fabaceae",
published = x[i],
distribution = "Brazil"),
filters=c("species")))
}
View(fabacea_list)
x <- 2008:2020
fabacea_list <- vector("list", length(x))
for(i in seq_along(x)){
fabacea_list[[i]] <- tidy(search_ipni(list(family = "Fabaceae",
published = x[i],
distribution = "Brazil"),
filters=c("species")))
}
fabacea_list[[13]]
fabacea_2008_2020 <- do.call("rbind", fabacea_list)
install.packages("plyr")
library(plyr)
fabacea_2008_2020 <- do.call("rbind.fill", fabacea_list)
View(fabacea_2008_2020)
distribution = "Brazil"))
published = 2008,
fabacea_2008_2020 <- do.call("rbind.fill", fabacea_list) %>%
relocate(family, genus, species)
View(fabacea_2008_2020)
View(angiosperms_bra)
colnames(angiosperms_bra)
fabacea_2008_2020_brasil <- do.call("rbind.fill", fabacea_list) %>%
relocate(family, genus, species)
fabaceae_missing <- read_csv("Data/Metadata/Angiosperms/ipni/Leguminosidae.csv")
fabaceae_missing <- read_csv("Data/Metadata/Angiosperms/ipni/Leguminosae.csv")
fabaceae_missing <- readxl::read_excel("Data/Metadata/Angiosperms/ipni/Leguminosae.xlsx")
View(fabaceae_missing)
###Fabaceae missing in Flora
fabaceae_2008_2020_faltantes <- fabaceae_missing %>%
filter(publicationYear %in% 2008:2020)
View(fabaceae_2008_2020_faltantes)
library(writexl)
##writing fabacea 2008 to 2020 absent in Flora
write_xlsx(fabaceae_2008_2020_faltantes,
path = "Data/Processed/Angiosperms/fabaceae_2008_2020_faltantes.xlsx")
write_xlsx(fabacea_2008_2020_brasil,
path = "Data/Processed/Angiosperms/fabacea_2008_2020_brasil_ipni.xlsx")
write_xlsx(fabacea_2008_2020_brasil,
path = "Data/Processed/Angiosperms/fabaceae_2008_2020_brasil_ipni.xlsx")
